<!DOCTYPE html>
<html lang="es">
<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>SOM Madrid - Simulador de producción fotovoltaica individual</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" 
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

    <!-- OpenLayers -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@v7.1.0/ol.css">
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.14.1/css/ol.css" type="text/css"> -->
    <style>
        .divTextArea {
            padding: 4px;
            padding-left: 10px;
            width: 100%;
            height: 100vh;
            border: solid 1px black;
            overflow: scroll;
            overflow-y: scroll;
            overflow-x: hidden;
        }

        .nav-link {
            color: black;
        }

        .btn-info {
            background-color: #80DEEA;
        }

    </style>


    <script src="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.15.1/build/ol.js"></script>

    <!-- I18n -->
    <script src="https://cdn.jsdelivr.net/npm/i18next@21.6.10/i18next.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery-i18next@1.2.1/jquery-i18next.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/i18next-browser-languagedetector@6.1.3/i18nextBrowserLanguageDetector.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/i18next-http-backend@1.3.1/i18nextHttpBackend.min.js"></script>
    
    <!-- Plotly-->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

    <!-- jspdf 
    <script src="https://unpkg.com/jspdf@2.5.1/dist/jspdf.es.min.js"></script>
    -->

    <script src="./js/jspdf.debug.js"></script>
    <script src='https://html2canvas.hertzen.com/dist/html2canvas.min.js'></script>
    <script src="https://unpkg.com/jspdf-autotable@3.5.22/dist/jspdf.plugin.autotable.js"></script>

    <!-- Funcion propia de gestion entre DOM y clases -->
    <script type="module"> import Dispatch from "./js/Dispatcher.js";</script>

</head>

<script type="text/javascript">
    window.addEventListener("load", function(event) {
    Dispatch('Inicializa eventos');
});
</script>

<body style="background-color:rgb(220, 249, 233)">
    <div class="row flex-fill align-items-center"> <!-- Menu de cabecera -->
        <img src="./datos/logo.jpg" class="float-left" style="width:220px;height:90px;" alt="SOM Energia Madrid">
        <div class="col-md-7 text-center" id="menu_screen">
            <h2 data-i18n="main_LBL_titulo"></h2>
        </div>
        <div class="col-md-2">
            <button class="btn btn-default tDyn pull-right" type="button" id="ayuda"  
            data-bs-toggle="tooltip" data-bs-placement="top" title="main_TT_ayuda">
            <span class="fa fa-question-circle-o"></span>
            </button>
            <button class="btn btn-default tDyn pull-right" type="button" id="parametros" data-bs-toggle="modal" 
            data-bs-target="#formularioParametros" data-bs-toggle="tooltip" data-bs-placement="top" title="main_TT_parametros"> 
            <span class="fa fa-cog"></span>
            </button>
            <button class="btn btn-default tDyn pull-right" type="button" id="informe"  
            data-bs-toggle="tooltip" data-bs-placement="top" title="main_TT_guardarPDF"><span class="fa fa-file-pdf-o"></span></button>
            </button>
            <button class="btn btn-default tDyn pull-right" type="button" id="contacto" data-bs-toggle="modal" 
            data-bs-target="#formularioContacto" data-bs-toggle="tooltip" data-bs-placement="top" title="main_TT_contacto">
            <span class="fa fa-envelope-o"></span>
            </button>
            <button class="btn btn-default tDyn pull-right" type="button" id="instrucciones"  
            data-bs-toggle="tooltip" data-bs-placement="top" title="main_TT_instrucciones" 
            onclick="window.open('./datos/Instrucciones.html', '_blank')"><span class="fa fa-info"></span>
            </button>
        </div>
        <div class="col-md-1 pull-right">
            <select class="form-select col-md-2" id="idioma" >
                <option value="es">Español</option>
                <option value="en">English</option>
                <option value="ca">Català</option>
                <option value="ga">Galego</option>
                <option value="eu">Euskera</option>
            </select>
        </div>
    </div>


    <div id="mmenu_screen" class="container-fluid main_container d-flex"> <!-- Contenedor general -->
        <div class="col-md-9 flex-fill" id="panelIzquierdo"> <!-- Panel izquierdo-->
            <div class="col-md-12 h-100 w-100">
                <div class="row mb-3"> <!-- Fila con las pestañas -->

                    <div class="col-md-12" id="menuPestanas">
                        <nav class="nav nav-pills nav-fill nav-tabs">
                            <button class="btn btn-info btn-sm tDyn col-md-1" type="button" id="btnAnterior"  
                            data-bs-toggle="tooltip" data-bs-placement="top" title="main_TT_anterior">
                            <span class="fa fa-arrow-left"></span></button>
                            </button>
                            <!-- Incluir data-bs-toggle="tab" en las proximas lineas si se quiere navegar por las pestañas directamente -->
                            <a class="nav-link active" id="nav-localizacion-tab"  href="#localizacion-tab" data-i18n="main_TAB_localizacion"></a>
                            <a class="nav-link" id="nav-consumo-tab"  href="#consumo-tab" data-i18n="main_TAB_consumo"></a>
                            <a class="nav-link" id="nav-resultados-tab" href="#resultados-tab" data-i18n="main_TAB_resultados"></a>
                            <a class="nav-link" id="nav-precios-tab"  href="#precios-tab" data-i18n="main_TAB_precios"></a>
                            <a class="nav-link" id="nav-graficos-tab"  href="#graficos-tab" data-i18n="main_TAB_graficos"></a>
                            <button class="btn btn-info btn-sm tDyn col-md-1 pull-right" type="button" id="btnSiguiente"
                            data-bs-toggle="tooltip" data-bs-placement="top" title="main_TT_siguiente">
                            <span class="fa fa-arrow-right"></span></button>
                            </button>
                        </nav>

                    </div>
                </div>

                <!-- Definir el contenido de las pestañas -->
                <div class="tab-content" id="nav-tabContent">

                    <!-- Contenido del tab desde donde se define la localizacion de la instalación -->
                    <div class="tab-pane show active" id="localizacion-tab" role="tabpanel">

                        <!-- Introduccion nombre del proyecto-->
                        <div class="row justify-content-center mb-3">
                            <label for="proyecto" class="col-md-1 col-form-label" data-i18n="proyecto_LBL_nombre_proyecto"></label>
                            <div class="col-md-11">
                                <input type="text" class="form-control" id="proyecto"> <!-- Tiene evento de cambio asociado en Dispatcher-->
                            </div>
                        </div>

                        <!-- Grupo de campos geograficos -->
                        <div class="row align-items-center mb-3">

                            <!-- Entrada lon-lat-->
                            <label for="lonlat" class="col-md-1 col-form-label pull-left" data-i18n="proyecto_LBL_lonlat"></label>
                            <div class="col-md-2">
                                <input type="text" class="form-control" id="lonlat" required>
                            </div>

                            <!-- Entrada inclinacion de los paneles -->
                            <label for="inclinacion" class="col-md-1 col-form-label" data-i18n="proyecto_LBL_inclinacion"></label>
                            <div class="col-md-2">
                                <input type="number" class="form-control tDyn" id="inclinacion" min="0" step="any"
                                data-bs-toggle="tooltip" data-placement="top" title="main_MSG_mayorQueCero"> <!-- Tiene evento de cambio asociado en Dispatcher-->
                            </div>

                            <!-- Uso de la opcion inclinacion optima-->
                            <div class="col-md-1">
                                <div class="form-check form-check-inline">
                                <input class="form-check-input align-middle" type="checkbox" id="inclinacionOptima" checked>
                                <label class="form-check-label align-middle" for="inclinacionOptima" data-i18n="proyecto_LBL_optimo"></label>
                                </div>
                            </div>

                            <!-- Entrada azimut -->
                            <label for="azimut" class="col-md-1 col-form-label" data-i18n="proyecto_LBL_azimut"></label>
                            <div class="col-md-2">
                                <input type="number" class="form-control" id="azimut">
                            </div>

                            <!-- Uso de la opcion azimut optimo -->
                            <div class="col-md-1">
                                <div class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox" id="azimutOptima" checked>
                                <label class="form-check-label" for="azimutOptima" data-i18n="proyecto_LBL_optimo"></label>
                                </div>
                            </div>
                        </div> <!-- Fin grupo de campos geograficos -->

                        <!-- campos para localizacion de zona o direccion -->
                        <div class="input-group mt-3">
                            <input type="text" class="form-control col-md-4 text-info" id="direccion" onfocus="this.value=''"> <!-- Tiene evento de cambio asociado en Dispatcher-->
                            <div class="input-group-prepend col-md-8">
                            <select class="form-select" id="candidatos" disabled></select>  <!-- Tiene evento de cambio asociado en Dispatcher-->
                            </div>
                        </div>
            
                        <!-- mapa -->
                        <div row id="headerMap">
                            <label class="col-md-9" id="accionMapa" data-i18n="proyecto_LBL_accion_mapa1"></label>
                            <button class="btn btn-info btn-sm tDyn col-md-1 pull-right" type="button" id="swapMapa"
                            data-bs-toggle="tooltip" data-bs-placement="top">Satélite</button>
                        </div>
                        
                        <div id="map" class="map" style="width: 100%; height: 60vh;"></div>
                    </div>

                    <!-- Contenido del tab desde donde se cargan los datos de consumo -->
                    <div class="tab-pane fade" id="consumo-tab" role="tabpanel">
                        <div class="row">
                            <div class="col-md-2">
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text" id="basic-addon1" data-i18n="precios_LBL_tarifa"></span>
                                    </div>
                                    <select class="form-select col-md-2" id="tarifa"> -->
                                        <option value="2.0TD">2.0TD</option>
                                        <option value="3.0TD">3.0TD</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-md-8">
                                <div class="input-group">
                                    <div class="custom-file">
                                        <input class="form-control" type="file" accept=".json" class="custom-file-input" id="tarifaFile">
                                    </div>
                                    <div class="input-group-prepend">
                                        <span class="input-group-text" id="basic-addon1">
                                            <a href="./datos/tarifas.json" 
                                            target="_blank" data-i18n="precios_LBL_ficheroTarifas"></a> 
                                        </span>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <div id="tablaTarifas2.0TD" class="row">
                            <div class="col col-md-2">
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text" id="basic-addon1">P1</span>
                                    </div>
                                    <input type="number" id="tarifaP1" min="0" step="any" class="form-control text-end ">
                                </div>
                            </div>
                            <div class="col col-md-2">
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                    <span class="input-group-text" id="basic-addon1">P2</span>
                                    </div>
                                    <input type="number"  id="tarifaP2" min="0" step="any" class="form-control text-end ">
                                </div>
                            </div>
                            <div class="col col-md-2">
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                    <span class="input-group-text" id="basic-addon1">P3</span>
                                    </div>
                                    <input type="number"  id="tarifaP3" min="0" step="any" class="form-control text-end ">
                                </div>
                            </div>
                            <div class="col col-md-3">
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                    <span class="input-group-text" id="basic-addon1" data-i18n="precios_LBL_compensa"></span>
                                    </div>
                                    <input type="number"  id="tarifaP0" min="0" step="any" class="form-control  text-end ">
                                </div>
                            </div>
                        </div>
                
                        <div id="tablaTarifas3.0TD" style="display: none;">
                            <div class="row">
                                <div class="col col-md-2">
                                    <div class="input-group">
                                        <div class="input-group-prepend">
                                        <span class="input-group-text" id="basic-addon1">P4</span>
                                        </div>
                                        <input type="number" id="tarifaP4" min="0" step="any" class="form-control text-end ">
                                    </div>
                                </div>
                                <div class="col-md-2">
                                    <div class="input-group">
                                        <div class="input-group-prepend">
                                        <span class="input-group-text" id="basic-addon1">P5</span>
                                        </div>
                                        <input type="number" id="tarifaP5" min="0" step="any" class="form-control text-end ">
                                    </div>
                                </div>
                                <div class="col col-md-2">
                                    <div class="input-group">
                                        <div class="input-group-prepend">
                                        <span class="input-group-text" id="basic-addon1">P6</span>
                                        </div>
                                        <input type="number" id="tarifaP6" min="0" step="any" class="form-control text-end ">
                                    </div>
                                </div>
                            </div>
                        </div>
                
                        <hr/>
                <!-- Seleccion del archivo con los consumos horarios CSV o potencia anual para el caso de perfil tipo REE -->
                        <div class="row align-items-center">
                            <div class="col-md-3 mb-3">
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input align-middle" type="radio" name="origen" id="desdeFichero" checked> <!-- Tiene evento de cambio asociado en Dispatcher-->    
                                    <label class="form-check-label align-middle" for="desdeFichero" ></label>
                                        <a href="./datos/Enlaces para descarga CSV individual.htm" 
                                        target="_blank" data-i18n="proyecto_LBL_guiaCSV"></a> 
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-8">
                                <input class="form-control" type="file" accept=".csv" id="csvfile"> <!-- Tiene evento de cambio asociado en Dispatcher-->
                            </div>
                        </div>

                        <div class="row align-items-center">
                            <div class="col-md-3 mb-3">
                                <div class="form-check form-check-inline">
                                    <label class="form-check-label float-right" for="desdePotencia"></label> 
                                        <a href="https://www.ree.es/sites/default/files/01_ACTIVIDADES/Documentos/Documentacion-Simel/BOE-A-2021-21395.pdf" 
                                        target="_blank" data-i18n="proyecto_LBL_metodoREE"></a>
                                    </label>
                                    <input class="form-check-input float-right col-md-8" type="radio" name="origen" id="desdePotencia"> <!-- Tiene evento de cambio asociado en Dispatcher-->    
                                </div>
                            </div>

                            <div class="col-md-8">
                                <div class="input-group">
                                    <span class="input-group-text" id="basic-addon3" data-i18n="proyecto_LBL_potenciaBase"></span>
                                    <input type="number" class="form-control " id="potenciaAno" min="0" step="any" disabled>
                                    <span class="input-group-text" id="cargarREE" data-i18n="proyecto_LBL_cargar"></span>  <!-- Tiene evento de cambio asociado en Dispatcher-->          
                                </div>
                            </div>
                        </div>

                        <div class="col-md-12">
                            <small id="csv_resumen" class="text-muted"></small>
                        </div>

                        <!-- Area reservada para el grafico consumos -->
                        <div class="row md-12 align-items-center">
                            <div class="col col-md-6">
                                <div id="graf_resumenConsumo"></div> <!-- Balance de produccion -->
                            </div>
                            <div class="col col-md-5">
                                <div id="graf_perfilDia"></div> <!-- Balance de consumo -->
                            </div>
                        </div>
                    </div>

                    <!-- Contenido del tab desde donde se vuelcan los resultados del balance de energia-->
                    <div class="tab-pane fade" id="resultados-tab" role="tabpanel">
                        <hr/>
                        <div class="form-group row justify-content-center">
                            <div class="col-md-3" id="panelesMinimo" data-i18n="resultados_LBL_panelesMinimo"></div>
                            <input class="col-md-1 text-end " type="number" min="0" step="1" id="numeroPaneles">

                            <div class="col-md-3 offset-md-1" id="potenciaPanel" data-i18n="resultados_LBL_potenciaPanel"></div>
                            <input class="col-md-1 text-end " type="number" min="0" step="any" id="potenciaUnitaria">
                        </div>
                        <hr/>

                        <div class="form-group row justify-content-center">
                            <div class="col-md-2" data-i18n="resultados_LBL_system_loss"></div>
                            <div class="col-md-2 text-end" id="system_loss"><a data-i18n="resultados_LBL_pendienteCalculo"></a></div>
                            <div class="col-md-2 offset-md-1" data-i18n="resultados_LBL_technology"></label></div>
                            <div class="col-md-2 text-end" id="technology"><a data-i18n="resultados_LBL_pendienteCalculo"></a></div>
                        </div>
                        <div class="form-group row justify-content-center">
                            <div class="col-md-2" data-i18n="resultados_LBL_PVGISinclinacion"></div>
                            <div class="col-md-2 text-end" id="PVGISinclinacion"><a data-i18n="resultados_LBL_pendienteCalculo"></a></div>
                            <div class="col-md-2 offset-md-1" data-i18n="resultados_LBL_inclinacionOptimal"></label></div>
                            <div class="col-md-2 text-end" id="inclinacionOptimal"><a data-i18n="resultados_LBL_pendienteCalculo"></a></div>
                        </div>
                        <div class="form-group row justify-content-center">
                            <div class="col-md-2" data-i18n="resultados_LBL_PVGISazimut"></div>
                            <div class="col-md-2 text-end" id="PVGISazimut"><a data-i18n="resultados_LBL_pendienteCalculo"></a></div>
                            <div class="col-md-2 offset-md-1" data-i18n="resultados_LBL_azimutOptimal"></label></div>
                            <div class="col-md-2 text-end" id="azimutOptimal"><a data-i18n="resultados_LBL_pendienteCalculo"></a></div>
                        </div>

                        <hr/>
                        <div class="form-group row justify-content-center">
                            <div class="col-md-2" data-i18n="resultados_LBL_objetivoHora"></div>
                            <div class="col-md-2 text-end" id="objetivoHora"><a data-i18n="resultados_LBL_pendienteCalculo"></a></div>
                            <div class="col-md-2 offset-md-1" data-i18n="resultados_LBL_potenciaDisponible"></label></div>
                            <div class="col-md-2 text-end" id="potenciaDisponible"><a data-i18n="resultados_LBL_pendienteCalculo"></a></div>
                        </div>
                        
                        <div class="form-group row justify-content-center">
                            <div class="col-md-2" data-i18n="resultados_LBL_consumoPFVdiaria"></div>
                            <div class="col-md-2 text-end" id="PFVDiaria"><a data-i18n="resultados_LBL_pendienteCalculo"></a></div>
                            <div class="col-md-2 offset-md-1" data-i18n="resultados_LBL_produccionMediaDiaria"></div>
                            <div class="col-md-2 text-end" id="produccionMediaDiaria"><a data-i18n="resultados_LBL_pendienteCalculo"></a></div>
                        </div>

                        <div class="form-group row justify-content-center">
                            <div class="col-md-2" data-i18n="resultados_LBL_consumoPFVmensual"></div>
                            <div class="col-md-2 text-end" id="PFVMensual"><a data-i18n="resultados_LBL_pendienteCalculo"></a></div>
                            <div class="col-md-2 offset-md-1" data-i18n="resultados_LBL_produccionMediaMensual"></div>
                            <div class="col-md-2 text-end" id="produccionMediaMensual"><a data-i18n="resultados_LBL_pendienteCalculo"></a></div>
                        </div>

                        <div class="form-group row justify-content-center">
                            <div class="col-md-2" data-i18n="resultados_LBL_consumoPFVanual"></div>
                            <div class="col-md-2 text-end" id="PFVAnual"><a data-i18n="resultados_LBL_pendienteCalculo"></a></div>
                            <div class="col-md-2 offset-md-1" data-i18n="resultados_LBL_produccionMediaAnual"></div>
                            <div class="col-md-2 text-end" id="produccionMediaAnual"><a data-i18n="resultados_LBL_pendienteCalculo"></a></div>
                        </div>

                        <hr/>

                        <div class="row justify-content-center">
                            <div class="col-md-2 tDyn" data-i18n="resultados_LBL_energiaFaltante"
                                data-bs-toggle="tooltip" data-bs-placement="top" title="resultados_TT_energiaFaltante">
                            </div>
                            <div class="col-md-2 text-end" id="energiaFaltante"><a data-i18n="resultados_LBL_pendienteCalculo"></a></div>
                            <div class="col-md-2 offset-md-1 tDyn" data-i18n="resultados_LBL_energiaSobrante"
                                data-bs-toggle="tooltip" data-bs-placement="top" title="resultados_TT_energiaSobrante">
                            </div>
                            <div class="col-md-2 text-end" id="energiaSobrante"><a data-i18n="resultados_LBL_pendienteCalculo"></a></div>
                        </div>

                        <div class="row justify-content-center">
                            <div class="col-md-2 tDyn" data-i18n="resultados_LBL_energiaFaltante%Consumo"
                            data-bs-toggle="tooltip" data-bs-placement="top" title="resultados_TT_energiaFaltante%Consumo">
                            </div>
                            <div class="col-md-2 text-end" id="energiaFaltante%Consumo"><a data-i18n="resultados_LBL_pendienteCalculo"></a></div>

                            <div class="col-md-2 offset-md-1 tDyn" data-i18n="resultados_LBL_energiaSobrante%Produccion"
                                data-bs-toggle="tooltip" data-bs-placement="top" title="resultados_TT_energiaSobrante%Produccion">
                            </div>
                            <div class="col-md-2 text-end" id="energiaSobrante%Produccion"><a data-i18n="resultados_LBL_pendienteCalculo"></a></div>    
                        </div>


                        <hr/>

                        <div class="form-group row justify-content-center">
                            <div class="col-md-2  tDyn" data-i18n="resultados_LBL_energíaDemandadaVersusGenerada"
                                data-bs-toggle="tooltip" data-bs-placement="top" title="resultados_TT_energíaDemandadaVersusGenerada">
                            </div>
                            <div class="col-md-2 text-end text-end" id="porcientoEnergiaAhorradaGenerada">
                                <a data-i18n="resultados_LBL_pendienteCalculo"></a>
                            </div>
                            <div class="col-md-2 offset-md-1 tDyn" data-i18n="resultados_LBL_energiaAhorrada"
                            data-bs-toggle="tooltip" data-bs-placement="top" title="resultados_TT_energiaAhorrada">
                            </div>
                            <div class="col-md-2 text-end" id="porcientoEnergiaAhorrada">
                                <a data-i18n="resultados_LBL_pendienteCalculo"></a>
                            </div>
                        </div>
                        <hr/>
                        


                        <div class="form-group row justify-content-center">
                            <div class="col-md-3 tDyn" data-i18n="resultados_LBL_kgCO2AnualAhorrado"></div>
                            <div class="col-md-3  text-end" id="CO2Anual"><a data-i18n="resultados_LBL_pendienteCalculo"></a></div>
                        </div>
                        <hr/>

                        <div class="row justify-content-center">
                            <div class="col-md-3 text-center tDyn" data-i18n="resultados_LBL_autoconsumoMedioAnual"
                            data-bs-toggle="tooltip" data-bs-placement="top" title="resultados_TT_autoconsumoMedioAnual">
                            </div>
                            <div class="col-md-3 text-center tDyn" data-i18n="resultados_LBL_autosuficienciaMediaAnual"
                            data-bs-toggle="tooltip" data-bs-placement="top" title="resultados_TT_autosuficienciaMediaAnual">
                            </div>
                            <div class="col-md-3 text-center tDyn" data-i18n="resultados_LBL_autosuficienciaMaxima"
                            data-bs-toggle="tooltip" data-bs-placement="top" title="resultados_TT_autosuficienciaMaxima">
                        </div>
                        </div>
                        <div class="row justify-content-center">
                            <div class="col-md-3 text-center" id="porcientoAutoconsumo"><a data-i18n="resultados_LBL_pendienteCalculo"></a></div>
                            <div class="col-md-3 text-center" id="porcientoAutosuficiencia"><a data-i18n="resultados_LBL_pendienteCalculo"></a></div>
                            <div class="col-md-3 text-center" id="autosuficienciaMaxima"><a data-i18n="resultados_LBL_pendienteCalculo"></a></div>
                        </div>
                        <hr/>

                        <!-- Area reservada para el grafico resumen -->
                        <div class="tab-pane fade" id="graficosResumen-tab" role="tabpanel" aria-labelledby="graficosResumen-tab"><a data-i18n="resultados_LBL_graficoResumen"></a></div>
                            <div id="graf_resumen"></div>
                    </div>

                    <!-- Contenido del tab desde donde se vuelcan los resultados económico y financiero-->
                    <div class="tab-pane fade" id="precios-tab" role="tabpanel">

    
                        <div class="form-group row justify-content-center">
                            <div class="col-md-3" data-i18n="precios_LBL_gastoAnualSinPlacas"></div>
                            <div class="col-md-1 text-end" id="gastoAnualSinPlacas"><a data-i18n="precios_LBL_pendienteCalculo"></a></div>
                            <div class="col-md-3 offset-md-1" data-i18n="precios_LBL_gastoAnualConPlacas"></div>
                            <div class="col-md-1 text-end" id="gastoAnualConPlacas"><a data-i18n="precios_LBL_pendienteCalculo"></a></div>
                        </div>
                        <div class="form-group row justify-content-center">
                            <div class="col-md-3" data-i18n="precios_LBL_ahorroAnual"></div>
                            <div class="col-md-1 text-end" id="ahorroAnual"><a data-i18n="precios_LBL_pendienteCalculo"></a></div>
                            <div class="col-md-3 offset-md-1" data-i18n="precios_LBL_ahorroAnualPorciento"></div>
                            <div class="col-md-1 text-end" id="ahorroAnualPorCiento"><a data-i18n="precios_LBL_pendienteCalculo"></a></div>
                        </div>
                        <div class="form-group row justify-content-center">
                            <div class="col-md-3" data-i18n="precios_LBL_noCompensadoAnual"></div>
                            <div class="col-md-1 text-end" id="noCompensado"><a data-i18n="precios_LBL_pendienteCalculo"></a></div>
                            <div class="col-md-3 offset-md-1" data-i18n="precios_LBL_costeInstalacion"></div>
                            <div class="col-md-1 text-end" id="costeInstalacion"><a data-i18n="precios_LBL_pendienteCalculo"></a></div>
                        </div>

                        <hr/>

                        <div class="form-group row">
                            <label for="ibi" class="offset-md-1 col-md-1 col-form-label" data-i18n="precios_LBL_IBI" ></label>
                            <div class="col-md-2">
                                <input type="number" class="form-control " min="0" step="any"  id="valorIBI">
                            </div>
                            <label for="subvencionIBI" class="col-md-2 col-form-label" data-i18n="precios_LBL_subvencionIBI" ></label>
                            <div class="col-md-2">
                                <input type="number" class="form-control " min="0" step="any" id="porcientoSubvencionIBI">
                            </div>
                            <label for="duracionSubvencionIBI" class="col-md-2 col-form-label" data-i18n="precios_LBL_duracion"></label>
                            <div class="col-md-2">
                                <input type="number" class="form-control " min="0" step="any" id="duracionSubvencionIBI">
                            </div>
                        </div>

                        <div class="row">
                            <label for="subvencionEU" class="col-md-2 offset-sm-4 col-form-label" data-i18n="precios_LBL_subvencionEU"></label>
                            <div class="col-md-3">
                                <select class="form-select" id="subvencionEU"> <!-- Tiene evento de cambio asociado en Dispatcher-->
                                    <option value="0" data-i18n="precios_LBL_sinSubvencion"></option>
                                    <option value="600" data-i18n="precios_LBL_600Subvencion"></option>
                                    <option value="710" data-i18n="precios_LBL_710Subvencion"></option>
                                    <option value="450" data-i18n="precios_LBL_450Subvencion"></option>
                                    <option value="535" data-i18n="precios_LBL_535Subvencion"></option>
                                </select>
                            </div>
                        </div>

                        <hr/>
                        
                        <div>
                            <table id="financiero" class="table table-striped text-end">
                                <thead class="thead-light">
                                    <tr>
                                        <th scope="col col-md-1" data-i18n="precios_LBL_año"></th>
                                        <th scope="col" data-i18n="precios_LBL_previo"></th>
                                        <th scope="col" data-i18n="precios_LBL_inversion"></th>
                                        <th scope="col" data-i18n="precios_LBL_ahorro"></th>
                                        <th scope="col" data-i18n="precios_LBL_descuentoIBI"></th>
                                        <th scope="col" data-i18n="precios_LBL_subvencion"></th>
                                        <th scope="col" data-i18n="precios_LBL_pendiente"></th>
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>

                        <div class="form-group row justify-content-center">
                            <div class="col-md-2" data-i18n="precios_LBL_VAN"></div>
                            <div class="col-md-2 text-end" id="VAN"><a data-i18n="precios_LBL_pendienteCalculo"></a></div>
                            <div class="col-md-2 offset-md-1" data-i18n="precios_LBL_TIR"></label></div>
                            <div class="col-md-2 text-end" id="TIR"><a data-i18n="precios_LBL_pendienteCalculo"></a></div>
                        </div>
                        <hr/>
                        <div class="row md-12">
                            <div class="col md-6">
                                <div id="graf_5"></div>
                            </div>
                            <div class="col md-5">
                                <div id="graf_4"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Contenido del tab reservado para los gráficos -->
                    <div class="tab-pane fade" id="graficos-tab" role="tabpanel"><a data-i18n="graficos_LBL_descripcion"></a>
                        <div class="row md-12">
                            <div class="col md-6 offset-md-3">
                                <div id="graf_1"></div> <!-- consumos_y_generacion -->
                            </div>
                        </div>
                        <div class="row md-12">
                            <div class="col md-6">
                                <div id="graf_2"></div> <!-- Balance de produccion -->
                            </div>
                            <div class="col md-6">
                                <div id="graf_3"></div> <!-- Balance de consumo -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-3 flex-fill collapse" id="panelDerecho"> <!-- Panel derecho -->
            <label class="col-md-12 col-form-label text-center" style="background-color: #73a7cc;" data-i18n="ayuda_TIT_panel"></label>

            <!-- Zona donde se van dando instrucciones de uso -->
            <div> 
                <p id="titulo" class="p-2 h5" data-i18n="proyecto_LBL_descripcion"></p>
            </div>
            <div class="divTextArea" id="texto">
            </div>
        </div>
    </div> <!-- Fin de los paneles operativos -->

    <!-- formulario modal de parametros -->
    <div class="modal fade" id="formularioParametros" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-info">
                    <h5 class="modal-title" id="tituloParametros" data-i18n="main_TAB_parametros"></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" style="background-color:rgb(169, 248, 206)">
                    <div class="container-fluid">
                        <div class="row mb-3">
                            <label for="conversionCO2" class="col-md-5 col-form-label" data-i18n="parametros_LBL_kgCO2AnualPorkWh"></label>
                            <div class="col-md-3"><input type="number" min="0" step="any" class="form-control " id="conversionCO2"></div>
                        </div>
                        <div class="row mb-3">
                            <label for="impuestoElectrico" class="col-md-5 col-form-label" data-i18n="parametros_LBL_impuestoElectrico"></label>
                            <div class="col-md-3"><input type="number" min="0" step="any" class="form-control " id="impuestoElectrico"></div>
                        </div>
                        <div class="row mb-3">
                            <label for="IVA" class="col-md-5 col-form-label" data-i18n="parametros_LBL_IVA"></label>
                            <div class="col-md-3"><input type="number" min="0" step="any" class="form-control " id="IVA"></div>
                        </div>
                        <div class="row mb-3">
                            <label for="euroxkWpinstalado" class="col-md-5 col-form-label" data-i18n="parametros_LBL_EurosxkWpInstalado"></label>
                            <div class="col-md-3"><input type="number" min="0" step="any" class="form-control " id="euroxkWpinstalado"></div>
                        </div>
                        <div class="row mb-3">
                            <label for="perdidasSistema" class="col-md-5 col-form-label" data-i18n="parametros_LBL_perdidasSistema"></label>
                            <div class="col-md-3"><input type="number" min="0" step="any" class="form-control " id="perdidasSistema"></div>
                        </div>
                        <div class="row mb-3">
                            <label for="interesVAN" class="col-md-5 col-form-label" data-i18n="parametros_LBL_interesVAN"></label>
                            <div class="col-md-3"><input type="number" min="0" step="any" class="form-control " id="interesVAN"></div>
                        </div>
                        <div class="row mb-3">
                            <label for="potenciaPanelInicio" class="col-md-5 col-form-label" data-i18n="parametros_LBL_potenciaPanelInicio"></label>
                            <div class="col-md-3"><input type="number" min="0" step="any" class="form-control " id="potenciaPanelInicio"></div>
                        </div>

                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text">Tecnologia</span>
                            </div>
                            <select class="form-select col-md-2" id="tecnologia"> <!-- Tiene evento de cambio asociado en Dispatcher-->   
                                <option value="crystSi">Crystaline silicon</option>
                                <option value="CIS">CIS</option>
                                <option value="Cadmium Telluride">cdTe</option>
                                <option value="Unknown">Desconocido</option>
                            </select>
                        </div>

                        <div class="row mb-3">
                            <label class="col-md-12 col-form-label">Volcado de datos</label>
                        </div>

                        <div class="row mb-3 justify-content-center">
                            <button type="button" class="btn btn-info col-md-2" id="dumpConsumo">Consumo</button>
                            <button type="button" class="btn btn-info col-md-2" id="dumpRendimiento">Rendimiento</button>
                            <button type="button" class="btn btn-info col-md-2" id="dumpProduccion">Producción</button>
                            <button type="button" class="btn btn-info col-md-2" id="dumpBalance">Balance</button>
                            <button type="button" class="btn btn-info col-md-2" id="dumpPrecioOriginal">Precios sin paneles</button>
                            <button type="button" class="btn btn-info col-md-2" id="dumpPrecioConPaneles">Precios con paneles</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- formulario modal de contacto -->
    <div class="modal fade" id="formularioContacto" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-info">
                    <h5 class="modal-title" id="tituloContacto" data-i18n="main_TAB_contacto"></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" style="background-color:rgb(169, 248, 206)">
                    <div class="container-fluid">
                    <form method="POST" name='formularioContacto' action="./contacto.php" enctype="multipart/form-data">
                        <div class="row mb-3">
                            <label for="nombre" class="col-md-2 col-form-label" data-i18n="contacto_LBL_nombre"></label>
                            <div class="col-md-9"><input type="text" class="form-control" name="nombre"></div>
                        </div>
                        <div class="row mb-3">
                            <label for="email" class="col-md-2 col-form-label" data-i18n="contacto_LBL_email"></label>
                            <div class="col-md-9"><input type="email" class="form-control" name="email" required></div>
                        </div>
                        <div class="row mb-3">
                            <label for="telefono" class="col-md-2 col-form-label" data-i18n="contacto_LBL_telefono"></label>
                            <div class="col-md-9"><input type="phone" class="form-control" name="telefono"></div>
                        </div>
                        <fieldset class="row mb-3">
                        <legend class="col-form-label col-md-3 pt-0" data-i18n="contacto_LBL_tipoPropuesta"></legend>
                        <div class="col-md-6">
                            <div class="form-check">
                            <input class="form-check-input" type="radio" name="gridRadios" id="gridError" value="error" checked>
                            <label class="form-check-label" for="gridError" data-i18n="contacto_LBL_error"></label>
                            </div>
                            <div class="form-check">
                            <input class="form-check-input" type="radio" name="gridRadios" id="gridMejora" value="mejora">
                            <label class="form-check-label" for="gridMejora" data-i18n="contacto_LBL_mejora"></label>
                            </div>
                            <div class="form-check">
                            <input class="form-check-input" type="radio" name="gridRadios" id="gridMensaje" value="comentario">
                            <label class="form-check-label" for="gridMensaje" data-i18n="contacto_LBL_comentario"></label>
                            </div>
                        </div>
                        </fieldset>

                        <div class="row mb-3">
                        <div class="col-md-6 offset-md-2">
                            <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="mantenerContacto">
                            <label class="form-check-label" for="mantenerContacto" data-i18n="contacto_LBL_respuesta">
                            </label>
                            </div>
                        </div>
                        </div>
                        <div class="row mb-3">
                            <label for="mensaje" class="col-md-2 col-form-label" data-i18n="contacto_LBL_mensaje"></label>
                            <div class="col-md-9"><textarea class="form-control" name="mensaje" rows="3" required></textarea></div>
                        </div>
                        <button type="submit" value="Send" class="btn btn-primary" data-i18n="contacto_LBL_enviar"></button>
                    </form>
                    </div>
                </div>
            </div>
        </div>
    </div>


</body>

<!-- Bootstrap  -->
<script
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"
></script>

</html>
